{% extends "base.html" %}
    {% block content %}
    <div id="home2" class="bgImage" >
      <h1 style="text-align: center; color: yellow;margin: 10%;">Laughter will always be the best medicine. Have you had your shot today?<i class="fas fa-laugh    "></i>
    </div>

    {% if shorts %}
    <div class="container-sm border" style="border-radius: 20px;text-align: center;">
      <span style="background-color: black; color: yellow; border-radius: 0px 0px 10px 10px;">Editor's Choice</span>
      <h1>10 funny videos to start your day!</h1>

      {% for short in shorts %}
      <div style="margin: 0%; box-shadow: 5px 5px 5px gray; border-radius: 10px; margin-bottom: 5%;">
        <div class="embed-responsive embed-responsive-16by9"  style="border-radius: 10px; height: 80vh; margin-bottom: 5%;">

            <video style="border-radius:0px; padding: 0%;" class="embed-responsive-item"  controls>
              <source src="{{ short.video.url }}">
            </video>
          <!--<iframe id="video" style="border-radius:20px; height: 80%;" class="embed-responsive-item" src="{{ short.video.url }}" allowfullscreen></iframe>-->
        </div>
        <div>
          <a id="source" href="{{short.source}}" class="btn btn-outline-info">Source</a>
            {% if user.is_authenticated %}
            <form  method="POST">
                {% csrf_token %}

                <button type="submit" name="short_id" value="{{short.id}}" class="Shorter btn btn-prmary btn btn-sm" id="like_count_{{short.id}}" style="margin-top: 1%;">
                  <i class="fa fa-thumbs-up"></i> {{short.like_count}} Laugh{{short.like_count|pluralize }}
                </button>
            </form>
            {% else %}
            <a class="btn btn-outline-info" href="{% url 'login' %}?next={{request.path}}">Log in to like this item!</a><br>
            {% endif %}
          
         
        </div>
      </div>
      {% endfor %}

    {% else %}
      <p>There are no shorts in the database.</p>
    {% endif %}
   
    <div style="text-align: center; margin-top: 5%;">
      <h3 class="quote"><q>A good laugh is a mighty good thing,<br>
       a rather too scarce <br>
       a good thing
      </q></h3>
      <h5 class="quote">~ Herman Melville</h5>
  
    
    <script>

      $(document).on('click', '.Shorter', function (e) {
          e.preventDefault();
          var shortid = $(this).val();
          var button = $(this);
          $.ajax({
              type: 'POST',
              url: '{% url "like_short" %}',
              data: {
                  postid: shortid,
                  csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
                  action: 'post'
              },
              success: function (json) {
                var likeCountElement = document.getElementById("like_count_" + shortid);
                likeCountElement.textContent = json.result + " Laugh" + (json.result == 1 ? "" : "s");
              },
              error: function (xhr, errmsg, err) {

              }
          });
      });
      
    </script>
    {% endblock %}
   