{% extends "base.html" %}
    {% block content %}
    <div id="home2" class="bgImage" >
      <h1 style="text-align: center; color: yellow; margin: 10%;">A day without memes is full of stress, depression and hypertension. Laugh to live! <i class="fas fa-laugh    "></i>
    </div>

    {% if memes %}
    <div class="container-sm border" style="border-radius: 20px;text-align: center;">
      <span style="background-color: black; color: yellow; border-radius: 0px 0px 10px 10px;">Editor's Choice</span>
      <h1>10 funny memes to start your day!</h1>

      {% for meme in memes %}

      <div style="padding-top: 10%; max-width: inherit; "  >

            <a target="_blank" href="{{ meme.image.url }}" class="text-center">
              <img class="img-fluid" id="meme" src="{{ meme.image.url }}" alt="" >
            </a>
            {% if user.is_authenticated %}
            <form  method="POST">
                {% csrf_token %}

                <button type="submit" name="meme_id" value="{{meme.id}}" class="Memer btn btn-prmary btn btn-sm" id="like_count_{{meme.id}}" style="margin-top: 2%;">
                  <i class="fa fa-thumbs-up"></i> {{meme.like_count}} Laugh{{meme.like_count|pluralize }}
                </button>
            </form>
            {% else %}
            <a class="btn btn-outline-info" href="{% url 'login' %}?next={{request.path}}">Log in to like this item!</a><br>
            {% endif %}
            

      {% endfor %}

    {% else %}
      <p>There are no memes in the database.</p>
    {% endif %}
    </div>  
    <div style="text-align: center; margin-top: 5%;">
      <h3 class="quote"><q>There's nothing in the<br>
       world so irresistibly <br>
       contagious as laughter
      </q></h3>
      <h5 class="quote">~ Charles Dickens</h5>
    </div> 
    
    <script>

      $(document).on('click', '.Memer', function (e) {
          e.preventDefault();
          var memeid = $(this).val();
          var button = $(this);
          $.ajax({
              type: 'POST',
              url: '{% url "likeM" %}',
              data: {
                  postid: memeid,
                  csrfmiddlewaretoken: $('input[name=csrfmiddlewaretoken]').val(),
                  action: 'post'
              },
              success: function (json) {
                var likeCountElement = document.getElementById("like_count_" + memeid);
                likeCountElement.textContent = json.result + " Laugh" + (json.result == 1 ? "" : "s");
              },
              error: function (xhr, errmsg, err) {

              }
          });
      });
      
    </script>


{% endblock %}

   